(()=>{"use strict";const e=(()=>{let n="";function r(e){t.getCurrentProjectName().textContent="project: "+e,n=e}function l(e){t.addTaskToGridContainer(function(e){let r=document.createElement("div");r.classList="task";let l=document.createElement("p");l.classList="task-text",l.textContent=e.getTitle();let c=document.createElement("p");c.classList="task-date",c.textContent=e.getDate();let i=document.createElement("span");return i.onclick=function(){!function(e,n,r){o.deleteTaskFromProject(e,n),t.deleteTaskFromGridContainer(r)}(n,e.getTitle(),r)},i.textContent="X",r.appendChild(l),r.appendChild(c),r.appendChild(i),r}(e))}function a(e){"hidden"===e.style.visibility?e.style.visibility="visible":e.style.visibility="hidden"}function u(e){"display-none"===e.classList[0]?e.classList="add-cancel-project-container":e.classList="display-none"}return{projectToElment:function(e){let c=e,i=document.createElement("div");i.className="project";let a=document.createElement("p");a.textContent=c.getTitle();let u=document.createElement("span");u.textContent="x",i.onclick=function(){n!==c.getTitle()?(t.deleteAllElementsFromGrid(),r(c.getTitle()),function(e){let t=e,n=t.length;for(let e=0;e<n;e++)l(t[e])}(o.getProject(c.getTitle()).getTaskArr())):console.log("user press on same project do nothing")},u.onclick=function(){let e=c.getTitle();alert("project "+e),t.deleteElementFromSideBar(i),o.deleteProject(e),t.deleteAllElementsFromGrid()},i.appendChild(a),i.appendChild(u),function(e){t.addElementToSideBar(e)}(i)},_initAddBtn:function(){let e=document.querySelector("#add-btn");return e.onclick=function(){let e=t.getInputForm();""!==e.value?(c.newProject(e.value),e.value=""):alert("name cannot be empty")},e},_initCancelBtn:function(){let e=document.querySelector("#cancel-btn");return e.onclick=function(){a(t.getProjectBtn()),u(t.getPopUpForm()),t.getInputForm().value=""},e},_initForm:function(){return document.querySelector("#new-project-name")},_initMenuItem:function(){let e=document.querySelector(".menu-icon");return e.onclick=function(){var e;"side-bar"===(e=t.getSideBar()).classList[0]?e.classList="display-none":e.classList="side-bar"},e},_initProjectBtn:function(){let e=document.querySelector("#add-project-btn");return e.onclick=function(){a(e),u(t.getPopUpForm())},e},_initSideBar:function(){return document.querySelector("#sidebar")},_initNewProjectForm:function(){return document.querySelector("#popup-form")},_initPlusIcon:function(){let e=document.querySelector("#plus-icon");return e.onclick=function(){t.getModal().style.display="block"},e},errorAlret:function(e){alert(e)},_initModalAddBtn:function(){let r=document.querySelector("#modal-add-btn");return r.onclick=function(){!function(){let r=t.getModalTaskForm().value,l=t.getModalTaskDate().value;l=""!==l?l.split("-").reverse().join("-"):"date not given";let c=i.newTask(r,"",l);o.addTaskToProject(n,c),e.tasksToElement(c),t.clearFormValues()}()},r},_initModalCancelBtn:function(){let e=document.querySelector("#modal-cancel-btn");return e.onclick=function(){t.getModal().style.display="none",t.clearFormValues()},e},tasksToElement:l,subTitleOfCurrentProject:r}})(),t=(()=>{const t=e._initSideBar(),n=(e._initMenuItem(),e._initProjectBtn()),o=(e._initAddBtn(),e._initCancelBtn(),e._initForm(),e._initNewProjectForm()),r=document.querySelector("#new-project-name"),l=e._initPlusIcon(),c=(document.querySelector(".main"),document.querySelector("#grid-container")),i=document.querySelector("#project-name"),a=document.querySelector("#myModal"),u=(e._initModalAddBtn(),e._initModalCancelBtn(),document.querySelector("#modal-task-name")),d=document.querySelector("#modal-task-date");return window.onclick=function(e){e.target==a&&(a.style.display="none")},{addElementToSideBar:function(e){t.insertBefore(e,n)},deleteElementFromSideBar:function(e){t.removeChild(e)},getSideBar:function(){return t},getPopUpForm:function(){return o},getProjectBtn:function(){return n},getInputForm:function(){return r},getPlusSign:function(){return l},getModal:function(){return a},getModalTaskForm:function(){return u},getModalTaskDate:function(){return d},addTaskToGridContainer:function(e){c.appendChild(e)},getCurrentProjectName:function(){return i},clearFormValues:function(){u.value="",d.value=""},deleteTaskFromGridContainer:function(e){c.removeChild(e)},deleteAllElementsFromGrid:function(){for(;c.lastElementChild;)c.removeChild(c.lastElementChild)}}})(),n=(()=>{function e(e){let t={title:"",desc:"",date:"",prio:""};return t.title=e.getTitle(),t.desc=e.getDesc(),t.date=e.getDate(),t.prio=e.getPrio(),t}return{projectToObject:function(t){let n=t.getTaskArr(),o=n.length;for(let t=0;t<o;t++)n[t]=e(n[t]);return{title:t.getTitle(),toDoArr:n}},objectToProject:function(e){if(null===e)return void console.log("object empty");let t=e,n=t.toDoArr.length,o=[];if(n>0){o=t.toDoArr;for(let e=0;e<n;e++)o[e]=(r=o[e],i.newTask(r.title,r.desc,r.date,r.prio))}var r;return c.newProject(t.title,t.toDoArr)}}})(),o=(()=>{function e(e){let t=e;console.log("in save project"),console.log(t.getTaskArr()),localStorage.setItem(t.getTitle(),JSON.stringify(n.projectToObject(t)))}function t(e){return n.objectToProject(JSON.parse(localStorage.getItem(e)))}return{saveProject:e,getProject:t,saveFlag:function(e,t){localStorage.setItem(e,t)},getFlag:function(e){return JSON.parse(localStorage.getItem(e))},deleteProject:function(e){if("defualt"===e)return o.saveFlag("defualtFlag",!0),void localStorage.removeItem("defualt");localStorage.removeItem(e)},addTaskToProject:function(n,o){let r=t(n);c.addTask(r,o),e(r),console.log("in add task to project"),console.log(r.getTaskArr())},deleteTaskFromProject:function(n,o){let r=t(n);c.deleteTask(r,o),e(r)}}})(),r=function(){let t=localStorage.length,o=!0;for(var r=0;r<t;r++){let t=JSON.parse(localStorage.getItem(localStorage.key(r)));if("object"==typeof t&&"defualt"!==t.title){let r=n.objectToProject(t);if(e.projectToElment(r),o){let t=r.getTaskArr(),n=t.length;for(let o=0;o<n;o++)e.tasksToElement(t[o]);e.subTitleOfCurrentProject(r.getTitle()),o=!1}}}},l=(e,t=[])=>({getTitle:()=>e,getTaskArr:()=>t,setTitle(t){e=t},setTaskArr(e){t=e}}),c={newProject:function(t,n){return void 0===n&&function(t){if(function(t){return null===localStorage.getItem(t)?(console.log("in true"),!0):(e.errorAlret("a project with this name already exists"),!1)}(t)){let n=l(t);o.saveProject(n),e.projectToElment(n)}}(t),l(t,n)},addTask:function(e,t){e.getTaskArr().push(t)},deleteTask:function(e,t){let n=e.getTaskArr().length,o=e.getTaskArr();for(let e=0;e<n;e++)if(o[e].getTitle()===t){o.splice(e,1);break}e.setTaskArr(o)}},i={newTask:function(e,t,n,o){return((e,t="",n,o=1)=>({getTitle:()=>e,getDesc:()=>t,getDate:()=>n,getPrio:()=>o,setTitle(t){e=t},setDesc(e){t=e},setDate(e){n=e},setPrio(e){o=e}}))(e,t,n,o)}};var a,u;a=o.getFlag("defualtFlag"),void 0!==(u=o.getProject("defualt"))||!0!==a&&void 0!==a?a&&e.projectToElment(u):(o.saveProject(function(){let e=c.newProject("defualt",[]);return c.addTask(e,i.newTask("defualt","this is a defualt task","31/3/2021",5)),e}()),o.saveFlag("defualtFlag",!0)),r();let d=localStorage.length;for(var s=0;s<d;s++)console.log(localStorage.getItem(localStorage.key(s)))})();