(()=>{"use strict";const e=(()=>{let n="";function r(e){t.getCurrentProjectName().textContent="project: "+e,n=e}function c(e){t.addTaskToGridContainer(function(e){const r=document.createElement("div");r.classList="task";const c=document.createElement("p");c.classList="task-text",c.textContent=e.getTitle();const l=document.createElement("p");l.classList="task-date",l.textContent=e.getDate();const i=document.createElement("span");return i.onclick=function(){!function(e,n,r){o.deleteTaskFromProject(e,n),t.deleteTaskFromGridContainer(r)}(n,e.getTitle(),r)},i.textContent="X",r.appendChild(c),r.appendChild(l),r.appendChild(i),r}(e))}function a(e){"hidden"===e.style.visibility?e.style.visibility="visible":e.style.visibility="hidden"}function s(e){"display-none"===e.classList[0]?e.classList="add-cancel-project-container":e.classList="display-none"}return{projectToElment:function(e){const l=e,i=document.createElement("div");i.className="project";const a=document.createElement("p");a.textContent=l.getTitle();const s=document.createElement("span");s.textContent="x",a.onclick=function(){n!==l.getTitle()?(t.deleteAllElementsFromGrid(),r(l.getTitle()),function(e){const t=e,n=t.length;for(let e=0;e<n;e++)c(t[e])}(o.getProject(l.getTitle()).getTaskArr())):console.log("user press on same project do nothing")},s.onclick=function(){const e=l.getTitle();alert("project "+e),t.deleteElementFromSideBar(i),o.deleteProject(e),t.deleteAllElementsFromGrid()},i.appendChild(a),i.appendChild(s),function(e){t.addElementToSideBar(e)}(i)},_initAddBtn:function(){const e=document.querySelector("#add-btn");return e.onclick=function(){const e=t.getInputForm();""!==e.value?(l.newProject(e.value),e.value=""):alert("name cannot be empty")},e},_initCancelBtn:function(){const e=document.querySelector("#cancel-btn");return e.onclick=function(){a(t.getProjectBtn()),s(t.getPopUpForm()),t.getInputForm().value=""},e},_initForm:function(){return document.querySelector("#new-project-name")},_initMenuItem:function(){const e=document.querySelector(".menu-icon");return e.onclick=function(){var e;"side-bar"===(e=t.getSideBar()).classList[0]?e.classList="display-none":e.classList="side-bar"},e},_initProjectBtn:function(){const e=document.querySelector("#add-project-btn");return e.onclick=function(){a(e),s(t.getPopUpForm())},e},_initSideBar:function(){return document.querySelector("#sidebar")},_initNewProjectForm:function(){return document.querySelector("#popup-form")},_initPlusIcon:function(){const e=document.querySelector("#plus-icon");return e.onclick=function(){t.getModal().style.display="block"},e},errorAlret:function(e){alert(e)},_initModalAddBtn:function(){const r=document.querySelector("#modal-add-btn");return r.onclick=function(){!function(){const r=t.getModalTaskForm().value;let c=t.getModalTaskDate().value;c=""!==c?c.split("-").reverse().join("-"):"date not given";const l=i.newTask(r,"",c);o.addTaskToProject(n,l),e.tasksToElement(l),t.clearFormValues()}()},r},_initModalCancelBtn:function(){const e=document.querySelector("#modal-cancel-btn");return e.onclick=function(){t.getModal().style.display="none",t.clearFormValues()},e},tasksToElement:c,subTitleOfCurrentProject:r}})(),t=(()=>{const t=e._initSideBar(),n=(e._initMenuItem(),e._initProjectBtn()),o=(e._initAddBtn(),e._initCancelBtn(),e._initForm(),e._initNewProjectForm()),r=document.querySelector("#new-project-name"),c=e._initPlusIcon(),l=(document.querySelector(".main"),document.querySelector("#grid-container")),i=document.querySelector("#project-name"),a=document.querySelector("#myModal"),s=(e._initModalAddBtn(),e._initModalCancelBtn(),document.querySelector("#modal-task-name")),u=document.querySelector("#modal-task-date");return window.onclick=function(e){e.target===a&&(a.style.display="none")},screen.width>=768&&(t.classList="side-bar"),{addElementToSideBar:function(e){t.insertBefore(e,n)},deleteElementFromSideBar:function(e){t.removeChild(e)},getSideBar:function(){return t},getPopUpForm:function(){return o},getProjectBtn:function(){return n},getInputForm:function(){return r},getPlusSign:function(){return c},getModal:function(){return a},getModalTaskForm:function(){return s},getModalTaskDate:function(){return u},addTaskToGridContainer:function(e){l.appendChild(e)},getCurrentProjectName:function(){return i},clearFormValues:function(){s.value="",u.value=""},deleteTaskFromGridContainer:function(e){l.removeChild(e)},deleteAllElementsFromGrid:function(){for(;l.lastElementChild;)l.removeChild(l.lastElementChild)}}})(),n=(()=>{function e(e){const t={title:"",desc:"",date:"",prio:""};return t.title=e.getTitle(),t.desc=e.getDesc(),t.date=e.getDate(),t.prio=e.getPrio(),t}return{projectToObject:function(t){const n=t.getTaskArr(),o=n.length;for(let t=0;t<o;t++)n[t]=e(n[t]);return{title:t.getTitle(),toDoArr:n}},objectToProject:function(e){if(null===e)return void console.log("object empty");const t=e,n=t.toDoArr.length;let o=[];if(n>0){o=t.toDoArr;for(let e=0;e<n;e++)o[e]=(r=o[e],i.newTask(r.title,r.desc,r.date,r.prio))}var r;return l.newProject(t.title,t.toDoArr)}}})(),o=(()=>{function e(e){const t=e;console.log("in save project"),console.log(t.getTaskArr()),localStorage.setItem(t.getTitle(),JSON.stringify(n.projectToObject(t)))}function t(e){return n.objectToProject(JSON.parse(localStorage.getItem(e)))}return{saveProject:e,getProject:t,saveFlag:function(e,t){localStorage.setItem(e,t)},getFlag:function(e){return JSON.parse(localStorage.getItem(e))},deleteProject:function(e){if("defualt"===e)return o.saveFlag("defualtFlag",!0),void localStorage.removeItem("defualt");localStorage.removeItem(e)},addTaskToProject:function(n,o){const r=t(n);l.addTask(r,o),e(r),console.log("in add task to project"),console.log(r.getTaskArr())},deleteTaskFromProject:function(n,o){const r=t(n);l.deleteTask(r,o),e(r)}}})(),r=function(){const t=localStorage.length;let o=!0;for(let r=0;r<t;r++){const t=JSON.parse(localStorage.getItem(localStorage.key(r)));if("object"==typeof t&&"defualt"!==t.title){const r=n.objectToProject(t);if(e.projectToElment(r),o){const t=r.getTaskArr(),n=t.length;for(let o=0;o<n;o++)e.tasksToElement(t[o]);e.subTitleOfCurrentProject(r.getTitle()),o=!1}}}},c=(e,t=[])=>({getTitle:()=>e,getTaskArr:()=>t,setTitle(t){e=t},setTaskArr(e){t=e}}),l={newProject:function(t,n){return void 0===n&&function(t){if(function(t){return null===localStorage.getItem(t)?(console.log("in true"),!0):(e.errorAlret("a project with this name already exists"),!1)}(t)){const n=c(t);o.saveProject(n),e.projectToElment(n)}}(t),c(t,n)},addTask:function(e,t){e.getTaskArr().push(t)},deleteTask:function(e,t){const n=e.getTaskArr().length,o=e.getTaskArr();for(let e=0;e<n;e++)if(o[e].getTitle()===t){o.splice(e,1);break}e.setTaskArr(o)}},i={newTask:function(e,t,n,o){return((e,t="",n,o=1)=>({getTitle:()=>e,getDesc:()=>t,getDate:()=>n,getPrio:()=>o,setTitle(t){e=t},setDesc(e){t=e},setDate(e){n=e},setPrio(e){o=e}}))(e,t,n,o)}};(()=>{function t(){o.saveProject(function(){const e=l.newProject("defualt",[]);return l.addTask(e,i.newTask("defualt","this is a defualt task","31/3/2021",5)),e}())}return{defualtProject:t,initDefualtProject:function(){var n,r;n=o.getFlag("defualtFlag"),void 0!==(r=o.getProject("defualt"))||!0!==n&&void 0!==n?n&&e.projectToElment(r):(t(),o.saveFlag("defualtFlag",!0))}}})().initDefualtProject(),r()})();